import streamlit as st
import requests
from bs4 import BeautifulSoup
import pandas as pd
from io import BytesIO

# Fun√ß√£o para garantir que a URL seja completa
def complete_url(link, base_url="https://casadosdados.com.br"):
    if link.startswith('http'):
        return link
    return base_url + link

# Fun√ß√£o para extrair links das empresas
def get_company_links(search_term, uf):
    url = f"https://casadosdados.com.br/solucao/cnpj?q={search_term}&uf={uf}"
    headers = {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/124.0.0.0 Safari/537.36'}

    response = requests.get(url, headers=headers)
    soup = BeautifulSoup(response.content, 'html.parser')
    
    # Use um seletor CSS ou XPath adaptado para BeautifulSoup
    links = [a['href'] for a in soup.select('a[href]')]  # Adapte este seletor ao seu caso espec√≠fico

    return links

# Fun√ß√£o para extrair dados de uma empresa
def get_company_data(company_url):
    full_url = complete_url(company_url)  # Assegura que a URL √© completa
    headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.121 Safari/537.36"
    }
    response = requests.get(full_url, headers=headers)
    soup = BeautifulSoup(response.content, 'html.parser')
    
    # Extrai todos os divs que cont√™m as informa√ß√µes
    data_divs = soup.select('div[data-v-330d3ab8]')
    data = {}
    
    # Processa cada div para extrair as informa√ß√µes de label e conte√∫do
    for div in data_divs:
        label = div.find('label')
        content = div.find('p', class_='has-text-weight-bold')
        
        if label and content:  # Garante que ambos label e content existam
            key = label.text.strip().replace(':', '')  # Remove dois pontos se houver no final de label
            value = content.text.strip()
            data[key] = value

    return data

def to_excel(df):
    output = BytesIO()
    with pd.ExcelWriter(output, engine='openpyxl') as writer:
        df.to_excel(writer, index=False, sheet_name='Sheet1')
    processed_data = output.getvalue()
    return processed_data


# Interface do Streamlit
st.title("Prospec√ß√£o de Empresas com Web Scraping")
st.write("Este projeto foi desenvolvido para automatizar a coleta de informa√ß√µes de empresas de diversas √°reas, utilizando t√©cnicas de web scraping. O objetivo √© fornecer uma ferramenta eficaz para profissionais de vendas, marketing e an√°lise de mercado que buscam dados atualizados e relevantes para prospec√ß√£o de neg√≥cios.")

with st.container():
  search_term = st.text_input("Digite o segmento da empresa")
  uf = st.selectbox("Selecione a UF", [
      "AC", "AL", "AP", "AM", "BA", "CE", "DF", "ES", "GO", "MA",
      "MT", "MS", "MG", "PA", "PB", "PR", "PE", "PI", "RJ", "RN",
      "RS", "RO", "RR", "SC", "SP", "SE", "TO"
  ])

st.sidebar.image('https://github.com/guilhermeMirandaLtda/avaliador_material/blob/main/image/author.jpg?raw=true', width=150, )
st.sidebar.subheader("Guilherme Miranda Costa")
st.sidebar.write("""
                 <p><img src="data:image/jpeg;base64,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" alt="Email" style="width: 24px; height: 24px;">
                    guilherme.miranda.ltda@gmail.com</p>
                 <p><img src="data:image/png;base64,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" alt="cellphone" style="width: 24px; height: 24px;">
                    +55(99)9.8121-6058</p>
                 <a href="https://www.linkedin.com/in/guilherme-miranda-6657666a/">
                    <img src="https://cdn-icons-png.flaticon.com/256/174/174857.png" alt="LinkedIn" style="width: 24px; height: 24px;">
                    guilherme-miranda-6657666a
                </a>
                 """,unsafe_allow_html=True)

if st.button("Buscar"):
    links = get_company_links(search_term, uf)
    results = []

    for link in links:
        data = get_company_data(link)
        results.append(data)
    
    if results:  # Verifica se h√° dados antes de tentar criar o DataFrame
        # Cria um DataFrame para exibir os dados em tabela
        df = pd.DataFrame(results)
        st.table(df)  # Exibe os dados na tela

        # Prepara o arquivo Excel
        excel_file = to_excel(df)
        st.download_button(label="üì• Baixar Excel",
                           data=excel_file,
                           file_name="dados_empresa.xlsx",
                           mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")
    else:
        st.write("Nenhum dado encontrado para os termos fornecidos.")

